#:import NoTransition kivy.uix.screenmanager.NoTransition
<Sidebar>:
    menu_container: menu_box
    orientation: 'vertical'
    size_hint: None, None
    padding: [dp(8), dp(16), dp(8), dp(16)]
    spacing: dp(8)
    height: root.parent.height - dp(32) if root.parent else self.height
    width: self.width
    canvas.before:
        Color:
            rgba: 0, 0, 0, 0.45
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(12), dp(12), dp(12), dp(12)]
    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'top'
        size_hint: 1, 1
        BoxLayout:
            id: menu_box
            orientation: 'vertical'
            size_hint: 1, None
            height: self.minimum_height
            spacing: dp(8)

<SidebarButton>:
    orientation: 'horizontal'
    padding: [dp(12), 0, dp(12), 0]
    spacing: dp(12)
    size_hint_y: None
    height: dp(48)
    canvas.before:
        Color:
            rgba: (0.25, 0.28, 0.35, 0.6) if root.sidebar and root.sidebar.active_screen == root.screen_name else (0, 0, 0, 0)
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(8), dp(8), dp(8), dp(8)]
    Label:
        text: root.icon_text
        size_hint_x: None
        width: dp(24)
        halign: 'center'
        valign: 'middle'
        text_size: self.size
    Label:
        text: root.sidebar and root.sidebar.show_labels and root.text_label or ''
        opacity: root.sidebar.labels_opacity if root.sidebar else 0
        size_hint_x: None
        width: root.sidebar.label_width if root.sidebar else 0
        halign: 'left'
        valign: 'middle'
        text_size: self.size
        shorten: True
        shorten_from: 'right'

<LauncherRoot>:
    sidebar: sidebar
    content_manager: content_sm
    BoxLayout:
        id: content_container
        orientation: 'vertical'
        size_hint: 1, 1
        padding: [root.content_padding_left, dp(16), dp(16), dp(16)]
        spacing: dp(16)
        canvas.before:
            Color:
                rgba: 0, 0, 0, 0
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [dp(16), dp(16), dp(16), dp(16)]
        ScreenManager:
            id: content_sm
            transition: NoTransition()
            Screen:
                name: 'home'
                BoxLayout:
                    orientation: 'vertical'
                    spacing: dp(16)
                    padding: [0, 0, 0, dp(8)]
                    Label:
                        id: status_label
                        text: app.root.status_text if app.root else ''
                        size_hint_y: None
                        height: self.texture_size[1] + dp(12)
                        halign: 'left'
                        valign: 'middle'
                        text_size: self.width, None
                    Widget:
                    BoxLayout:
                        size_hint_y: None
                        height: dp(96)
                        padding: [0, dp(16), dp(16), dp(16)]
                        spacing: dp(16)
                        Widget:
                        Button:
                            id: play_button
                            text: app.translate('button.play') if app else 'Play'
                            size_hint: None, None
                            size: dp(72), dp(72)
                            font_size: '20sp'
                            on_release: app.root.play() if app.root else None
            Screen:
                name: 'library'
                BoxLayout:
                    orientation: 'vertical'
                    padding: [0, dp(16), dp(16), dp(16)]
                    spacing: dp(12)
                    Label:
                        text: 'Biblioteka w przygotowaniu'
                        size_hint_y: None
                        height: self.texture_size[1] + dp(12)
                        halign: 'left'
                        valign: 'middle'
                        text_size: self.width, None
                    Widget:
            Screen:
                name: 'store'
                BoxLayout:
                    orientation: 'vertical'
                    padding: [0, dp(16), dp(16), dp(16)]
                    spacing: dp(12)
                    Label:
                        text: 'Sklep w przygotowaniu'
                        size_hint_y: None
                        height: self.texture_size[1] + dp(12)
                        halign: 'left'
                        valign: 'middle'
                        text_size: self.width, None
                    Widget:
            Screen:
                name: 'settings'
                BoxLayout:
                    orientation: 'vertical'
                    padding: [dp(16), dp(16), dp(16), dp(16)]
                    spacing: dp(12)
                    Label:
                        id: game_dir_label
                        text: app.translate('settings.game_dir_label') if app else 'Game directory'
                        size_hint_y: None
                        height: self.texture_size[1] + dp(12)
                        halign: 'left'
                        valign: 'middle'
                        text_size: self.width, None
                    BoxLayout:
                        size_hint_y: None
                        height: dp(48)
                        spacing: dp(12)
                        Label:
                            id: game_dir_value
                            text: app.root.game_dir if app and app.root and app.root.game_dir else (app.translate('status.not_set') if app else 'Game directory: not set')
                            size_hint_x: 1
                            halign: 'left'
                            valign: 'middle'
                            text_size: self.width, None
                        Button:
                            id: choose_button
                            text: app.translate('settings.select_folder') if app else 'Select folder'
                            size_hint: None, None
                            size: dp(160), dp(44)
                            on_release: app.root.open_file_dialog() if app.root else None
                    Button:
                        id: background_button
                        text: app.translate('settings.change_background') if app else 'Change background'
                        size_hint: None, None
                        size: dp(200), dp(44)
                        on_release: app.select_background() if app else None
                    Label:
                        id: language_label
                        text: app.translate('settings.language_label') if app else 'Language'
                        size_hint_y: None
                        height: self.texture_size[1] + dp(12)
                        halign: 'left'
                        valign: 'middle'
                        text_size: self.width, None
                    Spinner:
                        id: language_spinner
                        size_hint: None, None
                        size: dp(220), dp(44)
                        values: []
                        on_text: app.on_language_selected(self.text) if app else None
                    Widget:
    Sidebar:
        id: sidebar
        pos: dp(16), dp(16)
        size_hint: None, None
        height: root.height - dp(32)

